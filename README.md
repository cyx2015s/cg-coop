# CG-Coop: 简单室内场景三维建模及真实感绘制系统

本项目是针对计算机图形学课程设计的综合三维建模与真实感渲染引擎。系统采用 **Rust** 语言编写，基于 **Glium (OpenGL)** 图形库和 **Dear ImGui** 用户界面库构建，实现了从基础体素建模、模型导入导出到高级光影效果渲染的完整管线。

---

## 🚀 核心特性

### 1. 几何建模与表达
- **基础体素**: 支持立方体、球体、圆柱、圆锥等基本体素的生成与实时编辑。
- **OBJ 导入导出**: 完整的三维网格导入导出功能，兼容主流三维软件。
- **NURBS 曲面**: (额外要求) 实现了高级 NURBS 曲面建模能力，支持复杂几何体的数学表达。

### 2. 真实感渲染
- **光照明模型**: 实现经典光照明模型，支持点光源、平衡光等多种光源类型。
- **实时阴影**: (额外要求) 实现了基于 **CSM (Cascaded Shadow Maps)** 和 **Omnidirectional Shadow Maps** 的实时阴影方案。
- **软阴影 (PCF)**: 引入百分比靠近过滤 (Percentage-Closer Filtering) 技术，提升阴影边缘的平滑度。
- **材质与纹理**: 支持多级纹理映射及材质参数（反射率、光泽度等）的实时调整。

### 3. 交互与场景管理
- **FPS 漫游模式**: 类《AimLab》的第一人称视角控制，支持自由缩放、旋转及碰撞检测。
- **实时 GUI**: 集成 ImGui 提供直观的属性编辑面板、场景树管理及实时渲染性能监控。
- **屏幕截取**: 支持一键保存当前渲染窗口到本地图片文件。

### 4. 扩展功能
- **内置 FPS 游戏演示**: 包含准星系统、武器模型显示及射击逻辑。
- **碰撞检测**: 系统集成实时碰撞检测算法，提升场景漫游的沉浸感。

---

## 🛠️ 技术栈

| 模块 | 技术实现 |
| :--- | :--- |
| **编程语言** | [Rust](https://www.rust-lang.org/) (Edition 2024) |
| **图形 API** | [Glium](https://github.com/glium/glium) (OpenGL 封装) |
| **数学库** | [glam](https://github.com/bitshifter/glam-rs) |
| **用户界面** | [imgui-rs](https://github.com/imgui-rs/imgui-rs) |
| **资源加载** | [tobj](https://github.com/twpayne/tobj), [image](https://github.com/image-rs/image) |

---

## 🏃 运行说明

### 环境要求
- 安装 [Rust 工具链](https://rustup.rs/) (建议使用最新 stable 版本)
- 支持 OpenGL 3.3+ 的显卡硬件

### 编译运行
```bash
# 克隆项目
git clone https://github.com/cyx2015s/cg-coop.git
cd cg-coop

# 以 Release 模式运行以获得最佳性能
cargo run --release
```

---

## 📝 课程要求实现进度

### 基本要求（已全部完成）
- [x] **基本体素建模**: 支持立方体、球、圆柱、圆锥、多面棱柱、多面棱台的建模表达。
- [x] **三维网格导入导出**: 实现了 OBJ 格式的完整导入与导出功能。
- [x] **材质与纹理**: 具备基本材质属性编辑及纹理贴图的显示能力。
- [x] **几何变换**: 支持对场景对象进行旋转、平移、缩放等基本几何变换。
- [x] **光照明模型与光源编辑**: 实现了经典光照模型，并支持实时调整光源位置、强度等参数。
- [x] **场景漫游**: 完善的观察功能，包含 Zoom In/Out, Pan, Orbit, Zoom To Fit 等。
- [x] **屏幕截取**: 能够实时捕捉渲染窗口并保存为图像文件。

### 额外要求（已完成部分）
- [x] **NURBS 曲面建模**: 实现了高级非均匀有理 B 样条曲面建模能力。
- [x] **实时碰撞检测**: 漫游模式下集成了物理碰撞检测系统。
- [x] **高级光照明**: 实现了 **实时阴影 (CSM / Omnidirectional Shadow Map)** 及 **软阴影 (PCF)**。
- [x] **三维游戏构建**: 基于此引擎开发了具有可玩性的 FPS 射击游戏演示。
- [x] **对象表达能力**: 场景中能够表达门、窗、墙等特定建筑对象。
- [ ] **移动平台实现**: (当前为桌面端 Rust 实现)
- [ ] **增强现实 (AR) 结合**: (未集成)

---

## 📂 项目结构

- `src/core/`: 引擎核心逻辑、数学工具与资源管理。
- `src/geometry/`: 几何形状定义，包括基本体素与 NURBS。
- `src/render/`: 渲染管线、Shader 管理与阴影映射实现。
- `src/scene/`: 场景图构建、相机控制与世界状态管理。
- `src/ui/`: 基于 ImGui 的 UI 组件库。

---

> **Note**: 本项目在开发过程中保留了部分原始痕迹以证明自主开发完成。若需进行二次开发，建议参考 `src/render` 下的渲染通路实现方案。